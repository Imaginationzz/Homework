<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <style>
            body {
            background-color: #141414;
            color:#bfb8a9;
        }
        h2,
        h3,
        h4 {
            color: #bfb8a9
        }

        p {
            color: #bfb8a9
        }

        hr {
            border: 1px solid #2d2d2d
        }

        h1 {
            font-size: 4rem;
            color: white;
        }
    </style>
    <title>Backoffice</title>
  </head>
  <body>
    <body>
        <nav class="navbar navbar-black bg-black">
            <a class="navbar-brand" href="homepage.html">
                <img src="https://upload.wikimedia.org/wikipedia/commons/0/08/Netflix_2015_logo.svg" width="100"
                    height="80px" alt="" loading="lazy">
            </a>
        </nav>
        <div class="container">
            <h1 class="my-3">Add a Movie</h1>
            <form onsubmit="handleSubmit(event)">
                <div class="form-group">
                    <label for="name">Movie Name</label>
                    <input type="text" class="form-control" id="name"
                        placeholder="Movie Name">
                    </div>
                            <div class="form-group">
                                <label for="category">Movie Category</label>
                                <input type="text" class="form-control" id="category"
                                    placeholder="Movie Category">
                            </div>
                            <div class="form-group">
                                <label for="description">Movie Description</label>
                                <textarea class="form-control" id="description" rows="3"></textarea>
                              </div>
                <div class="form-group">
                    <label for="ImageUrl">Image URL</label>
                    <input type="text" class="form-control" id="ImageUrl"
                        placeholder="Image URL">
                </div>
                <div class="form-group">
                    <button
                      class="btn btn-primary"
                      type="submit"
                      value="Submit Movie"
                    >
                      Submit Movie
                    </button>
            </form>
        </div>

    <!-- Optional JavaScript; choose one of the two! -->
<script>
const url = "https://striveschool-api.herokuapp.com/api/movies/"
const handleSubmit = (e) => {
        e.preventDefault(); // preventing the default browser event handling
        submitMovie();
      };

const submitMovie = async () => {
            let movie = {
                // gathering the data from the form, field by field
                name: document.querySelector("#name").value,
                description: document.querySelector("#description").value,
                category: document.querySelector("#category").value,
                imageUrl: document.querySelector("#ImageUrl").value,
            };

            try {
                let response = await fetch(url, {
                    // our POST request is made with the fetch method as well!
                    method: "POST", // declaring the CRUD method
                    body: JSON.stringify(movie), // we need to stringify the JS object in order to send it
                    headers: new Headers({
                        // we need also to declare the content type
                        "Content-Type": "application/json",
                        "Authorization": "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1ZmFiYzU2ZjRiY2RlMTAwMTc2MTZhODciLCJpYXQiOjE2MDUyNTk4OTEsImV4cCI6MTYwNjQ2OTQ5MX0.6s_JyPT3mCEzoKRTjowlEpvZcIiJPV4T9KwSgJPh9Ck",
                    }),
                });

                if (response.ok) {
                    // checking the ok property which stores the successful result of the operation
                    alert("Movie added successfully");
                    location.assign("homepage.html");
                } else {
                    alert("Something went wrong!");
                }
            } catch (error) {
                console.log(error);
            }
        };

</script>
    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>


  </body>
</html>